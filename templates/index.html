<!DOCTYPE html>
<html>
  <head>
    <style>
      div {
        font-size: 30px;
      }
    </style>
  </head>
  <body>
    <div>
      Lorem ipsum dolor sit amet consectetur adipisicing elit. Ab sequi deleniti
      molestiae provident dolore possimus! Reiciendis velit, possimus delectus
      nam iste et cupiditate, sit unde, accusantium totam illo necessitatibus
      at. Lorem ipsum dolor sit amet consectetur adipisicing elit. Ab sequi
      deleniti molestiae provident dolore possimus! Reiciendis velit, possimus
      delectus nam iste et cupiditate, sit unde, accusantium totam illo
      necessitatibus at. Lorem ipsum dolor sit amet consectetur adipisicing
      elit. Ab sequi deleniti molestiae provident dolore possimus! Reiciendis
      velit, possimus delectus nam iste et cupiditate, sit unde, accusantium
      totam illo necessitatibus at. Lorem ipsum dolor sit amet consectetur
      adipisicing elit. Ab sequi deleniti molestiae provident dolore possimus!
      Reiciendis velit, possimus delectus nam iste et cupiditate, sit unde,
      accusantium totam illo necessitatibus at. Lorem ipsum dolor sit amet
      consectetur adipisicing elit. Ab sequi deleniti molestiae provident dolore
      possimus! Reiciendis velit, possimus delectus nam iste et cupiditate, sit
      unde, accusantium totam illo necessitatibus at. Lorem ipsum dolor sit amet
      consectetur adipisicing elit. Ab sequi deleniti molestiae provident dolore
      possimus! Reiciendis velit, possimus delectus nam iste et cupiditate, sit
      unde, accusantium totam illo necessitatibus at. Lorem ipsum dolor sit amet
      consectetur adipisicing elit. Ab sequi deleniti molestiae provident dolore
      possimus! Reiciendis velit, possimus delectus nam iste et cupiditate, sit
      unde, accusantium totam illo necessitatibus at. Lorem ipsum dolor sit amet
      consectetur adipisicing elit. Ab sequi deleniti molestiae provident dolore
      possimus! Reiciendis velit, possimus delectus nam iste et cupiditate, sit
      unde, accusantium totam illo necessitatibus at. Lorem ipsum dolor sit amet
      consectetur adipisicing elit. Ab sequi deleniti molestiae provident dolore
      possimus! Reiciendis velit, possimus delectus nam iste et cupiditate, sit
      unde, accusantium totam illo necessitatibus at. Lorem ipsum dolor sit amet
      consectetur adipisicing elit. Ab sequi deleniti molestiae provident dolore
      possimus! Reiciendis velit, possimus delectus nam iste et cupiditate, sit
      unde, accusantium totam illo necessitatibus at.
    </div>

    <img
      style="margin-top: 600px; margin-bottom: 500px"
      src="https://rockcontent.com/wp-content/uploads/2017/09/propaganda-tio-sam-771x1024.jpg"
      id="img"
    />



    
    <script>

      
      var posicao = [];

      const vh = Math.max(
        document.documentElement.clientHeight || 0,
        window.innerHeight || 0
      );

      var body = document.getElementsByTagName("body")[0];
      var img = document.getElementById("img");

      var dic = {};
      var date = new Date();
      var timestamp = date.getTime();

      body.onscroll = funcao;
      function funcao() {
        var date = new Date();
        var timestamp = date.getTime();
        var rect = img.getBoundingClientRect();
        pos = rect.top - vh;
        if (pos < 0 && pos > -rect.height) {
          console.log("APARECEU NA TELA");
          dic[timestamp] = Math.abs(pos);
          console.log(dic);
        }
        if (pos < -rect.height) {
          console.log("saiu da tela");
        }
      }

      
      // --------------------------------------------------------------------------------------------------------------------------
      // --------------------------------------------------------------------------------------------------------------------------
      // --------------------------------------------------------------------------------------------------------------------------
    </script>

    <button onclick="mandar(dic)">acabei</button>
    <script>
      function mandar(dic){
        fetch('/hello', {

          // Declare what type of data we're sending
          headers: {
            'Content-Type': 'application/json'
          },

          // Specify the method
          method: 'POST',

          // A JSON payload
          body: JSON.stringify(dic)
          }).then(function (response) { // At this point, Flask has printed our JSON
          return response.text();
          }).then(function (text) {

          console.log('POST response: ');

          // Should be 'OK' if everything was successful
          console.log(text);
          });

      }
    </script>

    

  </body>
  </html>
